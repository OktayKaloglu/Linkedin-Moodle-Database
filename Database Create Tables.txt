CREATE TABLE Users(
User_id INT PRIMARY KEY NOT NULL,
User_name VARCHAR(30) NOT NULL,
Mail VARCHAR(30) NOT NULL,
Address VARCHAR(50),
Created_date DATE NOT NULL,
Post_number INT
);

CREATE TABLE Connections(
User_id_from INT NOT NULL,
User_id_to INT NOT NULL,
Is_confirm BOOLEAN NOT NULL,
PRIMARY KEY (User_id_from, User_id_to),
FOREIGN KEY (User_id_from) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (User_id_to) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Linkedin_Groups(
Group_id INT PRIMARY KEY NOT NULL,
Group_name VARCHAR(30) NOT NULL,
Host_user_id INT,
Created_date DATE NOT NULL,
FOREIGN KEY (Host_user_id) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Linkedin_Posts(
Post_id INT PRIMARY KEY NOT NULL,
Post_text VARCHAR(100),
Publish_date DATE NOT NULL,
Group_id INT,
Host_user_id INT NOT NULL,
FOREIGN KEY (Host_user_id) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Group_id) REFERENCES Linkedin_Groups(Group_id) ON DELETE CASCADE ON
UPDATE CASCADE
);

CREATE TABLE Post_Likes(
Post_id INT NOT NULL,
Host_user_id INT NOT NULL,
FOREIGN KEY (Host_user_id) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Post_id) REFERENCES Linkedin_Posts(Post_id) ON DELETE CASCADE ON
UPDATE CASCADE,
PRIMARY KEY (Post_id, Host_user_id)
);

CREATE TABLE Post_Comments(
Post_id INT NOT NULL,
Host_user_id INT NOT NULL,
Context VARCHAR(50),
FOREIGN KEY (Host_user_id) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Post_id) REFERENCES Linkedin_Posts(Post_id) ON DELETE CASCADE ON
UPDATE CASCADE,
PRIMARY KEY (Post_id, Host_user_id)
);

CREATE TABLE Group_Members(
Group_id INT NOT NULL,
User_id INT NOT NULL,
FOREIGN KEY (User_id) REFERENCES Users(User_id) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Group_id) REFERENCES Linkedin_Groups(Group_id) ON DELETE CASCADE ON
UPDATE CASCADE,
PRIMARY KEY (Group_id, User_id)
);

CREATE TABLE Members(
Ssn INT PRIMARY KEY NOT NULL,
BDate DATE NOT NULL,
Sex VARCHAR(1),
FName VARCHAR(20) NOT NULL,
LName VARCHAR(20) NOT NULL,
User_id INT,
Member_type VARCHAR(10) NOT NULL,
FOREIGN KEY (User_id) REFERENCES Users(User_id) ON DELETE SET NULL ON UPDATE
CASCADE
);

CREATE TABLE Messages(
Sender_Ssn INT NOT NULL,
Receiver_Ssn INT NOT NULL,
M_text VARCHAR(50),
FOREIGN KEY (Sender_Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Receiver_Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Skills(
Skill_id INT PRIMARY KEY NOT NULL,
Skill_name VARCHAR(50) NOT NULL
);

CREATE TABLE Skills_Endorse(
Skill_id INT NOT NULL,
Approved_Ssn INT NOT NULL,
Approver_Ssn INT NOT NULL,
FOREIGN KEY (Skill_id) REFERENCES Skills(Skill_id) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Approved_Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Approver_Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Companys(
Comp_id INT PRIMARY KEY NOT NULL,
Comp_name VARCHAR(30) NOT NULL,
Sector VARCHAR(20),
User_id INT,
FOREIGN KEY (User_id) REFERENCES Users(User_id) ON DELETE SET NULL ON UPDATE
CASCADE
);

CREATE TABLE Job_Adverts(
Comp_id INT NOT NULL,
Advert_id INT NOT NULL,
Advert_name VARCHAR(30) NOT NULL,
Working_Type VARCHAR(20),
Advert_time DATE NOT NULL,
PRIMARY KEY (Comp_id, Advert_id),
FOREIGN KEY (Comp_id) REFERENCES Companys(Comp_id) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Employees(
Ssn INT PRIMARY KEY NOT NULL,
Salary INT,
FOREIGN KEY (Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE Exp_On(
Ssn INT NOT NULL,
Comp_id INT NOT NULL,
Start_date DATE NOT NULL,
End_date DATE,
Comp_role VARCHAR(20) NOT NULL,
PRIMARY KEY (Ssn, Comp_id),
FOREIGN KEY (Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY (Comp_id) REFERENCES Companys(Comp_id) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE University(
Uni_id INT PRIMARY KEY NOT NULL,
Uni_name VARCHAR(20) NOT NULL,
Address VARCHAR(40)
);

CREATE TABLE Departments(
Dept_id INT PRIMARY KEY NOT NULL,
Dept_name VARCHAR(50) NOT NULL,
Uni_id INT NOT NULL,
FOREIGN KEY (Uni_id) REFERENCES University(Uni_id) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Instructors(
Ssn INT PRIMARY KEY NOT NULL,
Ins_type VARCHAR(20),
Dept_id INT NOT NULL,
FOREIGN KEY (Dept_id) REFERENCES Departments(Dept_id) ON DELETE CASCADE ON
UPDATE CASCADE,
FOREIGN KEY (Ssn) REFERENCES Members(Ssn)
);

ALTER TABLE Departments ADD Dean_Ssn INT;
ALTER TABLE Departments ADD FOREIGN KEY (Dean_Ssn) REFERENCES Instructors(Ssn) ON DELETE
CASCADE ON UPDATE CASCADE;
CREATE TABLE Courses(
Course_id INT PRIMARY KEY NOT NULL,
Course_name VARCHAR(50),
Dept_id INT NOT NULL,
Ins_Ssn INT NOT NULL,
FOREIGN KEY (Ins_Ssn) REFERENCES Instructors(Ssn),
FOREIGN KEY (Dept_id) REFERENCES Departments(Dept_id)
);

CREATE TABLE Moodle_Courses(
MCourse_id INT PRIMARY KEY NOT NULL,
Course_id INT NOT NULL,
FOREIGN KEY (Course_id) REFERENCES Courses(Course_id)
);

CREATE TABLE Projects(
MCourse_id INT NOT NULL,
Project_id INT NOT NULL,
Project_name VARCHAR(20),
Ins_Ssn INT NOT NULL,
FOREIGN KEY (MCourse_id) REFERENCES Moodle_Courses(MCourse_id),
FOREIGN KEY (Ins_Ssn) REFERENCES Instructors(Ssn),
PRIMARY KEY (MCourse_id, Project_id)
);

CREATE TABLE Students(
Ssn INT PRIMARY KEY NOT NULL,
GPA FLOAT,
Start_date DATE,
Dept_id INT NOT NULL,
Ins_Ssn INT NOT NULL,
FOREIGN KEY (Ssn) REFERENCES Members(Ssn) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY (Dept_id) REFERENCES Departments(Dept_id) ON DELETE CASCADE ON
UPDATE CASCADE,
FOREIGN KEY (Ins_Ssn) REFERENCES Instructors(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE
);

CREATE TABLE Take_Courses(
Course_id INT NOT NULL,
Student_Ssn INT NOT NULL,
FOREIGN KEY (Student_Ssn) REFERENCES Students(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Course_id) REFERENCES Courses(Course_id) ON DELETE CASCADE ON UPDATE
CASCADE,
PRIMARY KEY (Course_id, Student_Ssn)
);

CREATE TABLE Do_Projects(
Project_id INT NOT NULL,
MCourse_id INT NOT NULL,
Student_Ssn INT NOT NULL,
Grade INT,
FOREIGN KEY (Student_Ssn) REFERENCES Students(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (MCourse_id, Project_id) REFERENCES Projects(MCourse_id, Project_id) ON
DELETE CASCADE ON UPDATE CASCADE,
PRIMARY KEY (Project_id, MCourse_id, Student_Ssn)
);

CREATE TABLE Job_Apps(
Comp_id INT NOT NULL,
Advert_id INT NOT NULL,
Student_Ssn INT NOT NULL,
App_date DATE,
FOREIGN KEY (Student_Ssn) REFERENCES Students(Ssn) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY (Comp_id, Advert_id) REFERENCES Job_Adverts(Comp_id, Advert_id) ON
DELETE CASCADE ON UPDATE CASCADE,
PRIMARY KEY (Comp_id, Advert_id, Student_Ssn)
);